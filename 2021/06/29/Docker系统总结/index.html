<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="[TOC] 笔记太分散并不好，还是需要系统总结一下，方便后期查阅。">
<meta property="og:type" content="article">
<meta property="og:title" content="Docker系统总结">
<meta property="og:url" content="http://yoursite.com/2021/06/29/Docker%E7%B3%BB%E7%BB%9F%E6%80%BB%E7%BB%93/index.html">
<meta property="og:site_name" content="lb Blog">
<meta property="og:description" content="[TOC] 笔记太分散并不好，还是需要系统总结一下，方便后期查阅。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://yoursite.com/images/2021062901.png">
<meta property="og:image" content="http://yoursite.com/images/2019121701.png">
<meta property="og:image" content="http://yoursite.com/images/2019121702.png">
<meta property="og:image" content="http://yoursite.com/images/2021062902.png">
<meta property="og:image" content="c:%5CUsers%5Cadmin%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210629220324007.png">
<meta property="og:image" content="http://yoursite.com/images/2020072701.png">
<meta property="og:image" content="http://yoursite.com/images/2020110201.png">
<meta property="og:image" content="http://yoursite.com/images/2020110202.png">
<meta property="og:image" content="http://yoursite.com/images/2020110203.png">
<meta property="og:image" content="http://yoursite.com/images/2020110204.png">
<meta property="og:image" content="http://yoursite.com/images/2020110205.png">
<meta property="article:published_time" content="2021-06-29T13:32:02.000Z">
<meta property="article:modified_time" content="2021-06-29T15:28:02.163Z">
<meta property="article:author" content="liubin">
<meta property="article:tag" content="Docker">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://yoursite.com/images/2021062901.png">

<link rel="canonical" href="http://yoursite.com/2021/06/29/Docker%E7%B3%BB%E7%BB%9F%E6%80%BB%E7%BB%93/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Docker系统总结 | lb Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">lb Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/06/29/Docker%E7%B3%BB%E7%BB%9F%E6%80%BB%E7%BB%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="liubin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="lb Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Docker系统总结
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-06-29 21:32:02" itemprop="dateCreated datePublished" datetime="2021-06-29T21:32:02+08:00">2021-06-29</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Docker/" itemprop="url" rel="index"><span itemprop="name">Docker</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>[TOC]</p>
<p>笔记太分散并不好，还是需要系统总结一下，方便后期查阅。</p>
<a id="more"></a>

<h1 id="1-Docker的安装和介绍"><a href="#1-Docker的安装和介绍" class="headerlink" title="1 Docker的安装和介绍"></a>1 Docker的安装和介绍</h1><h2 id="1-1-Docker简介"><a href="#1-1-Docker简介" class="headerlink" title="1.1 Docker简介"></a>1.1 Docker简介</h2><p>Docker是基于go语言实现的云开源项目。</p>
<p>Docker的主要目标是<code>build,ship and run any app,anywhere</code>，也就是说通过对应用程序组件的封装，分发，部署，运行等生命周期的管理。使用户的app（可以是一个web应用程序或者数据库应用等）及其运行环境能够做到<code>一次封装，到处运行</code>。</p>
<p><img src="/images/2021062901.png" alt="image"></p>
<p> Linux容器技术的出现解决了这个问题。而Docker就是基于它的基础上发展过来的。将应用运行到docker容器上面，而Docker容器在任何操作系统上都是一致的，这就是实现跨平台跨服务器。只需要一次配置好环境，换到别的机子上就可以一键部署好，大大简化了操作。</p>
<blockquote>
<p>Docker官网：<a href="https://www.docker.com/" target="_blank" rel="noopener">https://www.docker.com/</a></p>
</blockquote>
<h2 id="1-2-Linux环境下安装docker"><a href="#1-2-Linux环境下安装docker" class="headerlink" title="1.2 Linux环境下安装docker"></a>1.2 Linux环境下安装docker</h2><blockquote>
<p>Docker分为社区版CE和企业版EE。CE版完全足够个人使用，选择stable版本即可。</p>
</blockquote>
<p>1.Docker 要求 CentOS 系统的内核版本高于 <code>3.10</code> ，查看本页面的前提条件来验证你的CentOS 版本是否支持 Docker 。</p>
<p>通过 <strong>uname -r</strong> 命令查看你当前的内核版本</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># uname -r</span></span><br></pre></td></tr></table></figure>

<p><img src="/images/2019121701.png" alt="image-20201217213427007"></p>
<p>2.使用 <code>root</code> 权限登录 Centos。确保 yum 包更新到最新。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sudo yum update</span></span><br></pre></td></tr></table></figure>

<p>3.卸载旧版本(如果安装过旧版本的话)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sudo yum remove docker  docker-common docker-selinux docker-engine</span></span><br></pre></td></tr></table></figure>

<p>4.安装需要的软件包， yum-util 提供yum-config-manager功能，另外两个是devicemapper驱动依赖的</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sudo yum install -y yum-utils device-mapper-persistent-data lvm2</span></span><br></pre></td></tr></table></figure>

<p>5.设置yum源</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sudo yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo</span></span><br></pre></td></tr></table></figure>

<p><img src="/images/2019121702.png" alt="image"></p>
<p>6.可以查看所有仓库中所有docker版本，并选择特定版本安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># yum list docker-ce --showduplicates | sort -r</span></span><br></pre></td></tr></table></figure>

<p>7.安装docker</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sudo yum install docker-ce  #由于repo中默认只开启stable仓库，故这里安装的是最新稳定版</span></span><br><span class="line"><span class="comment"># sudo yum install &lt;FQPN&gt;  # 例如：sudo yum install docker-ce-17.12.0.ce</span></span><br></pre></td></tr></table></figure>

<p>8.启动docker</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sudo systemctl start docker</span></span><br></pre></td></tr></table></figure>

<p>9.设置开机自启动</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sudo systemctl enable docker</span></span><br></pre></td></tr></table></figure>

<p>10.验证安装是否成功(有client和service两部分表示docker安装启动都成功了)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># docker version</span></span><br></pre></td></tr></table></figure>



<h2 id="1-3-配置镜像加速"><a href="#1-3-配置镜像加速" class="headerlink" title="1.3 配置镜像加速"></a>1.3 配置镜像加速</h2><blockquote>
<p>阿里云界面：<a href="https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors" target="_blank" rel="noopener">https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors</a></p>
</blockquote>
<p>Docker客户端版本需要大于 <code>1.10.0</code> </p>
<p>可以通过修改daemon配置文件<code>/etc/docker/daemon.json</code>来使用加速器</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo mkdir -p /etc/docker</span><br><span class="line">sudo tee /etc/docker/daemon.json &lt;&lt;-<span class="string">'EOF'</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"registry-mirrors"</span>: [<span class="string">"https://26udi78a.mirror.aliyuncs.com"</span>]</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">sudo systemctl daemon-reload</span><br><span class="line">sudo systemctl restart docker</span><br></pre></td></tr></table></figure>

<h2 id="1-4-可能遇到的问题"><a href="#1-4-可能遇到的问题" class="headerlink" title="1.4 可能遇到的问题"></a>1.4 可能遇到的问题</h2><p>1.因为之前已经安装过旧版本的docker，在安装的时候报错如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Transaction check error:</span><br><span class="line">  file &#x2F;usr&#x2F;bin&#x2F;docker from install of docker-ce-17.12.0.ce-1.el7.centos.x86_64 conflicts with file from package docker-common-2:1.12.6-68.gitec8512b.el7.centos.x86_64</span><br><span class="line">  file &#x2F;usr&#x2F;bin&#x2F;docker-containerd from install of docker-ce-17.12.0.ce-1.el7.centos.x86_64 conflicts with file from package docker-common-2:1.12.6-68.gitec8512b.el7.centos.x86_64</span><br><span class="line">  file &#x2F;usr&#x2F;bin&#x2F;docker-containerd-shim from install of docker-ce-17.12.0.ce-1.el7.centos.x86_64 conflicts with file from package docker-common-2:1.12.6-68.gitec8512b.el7.centos.x86_64</span><br><span class="line">  file &#x2F;usr&#x2F;bin&#x2F;dockerd from install of docker-ce-17.12.0.ce-1.el7.centos.x86_64 conflicts with file from package docker-common-2:1.12.6-68.gitec8512b.el7.centos.x86_64</span><br></pre></td></tr></table></figure>

<p>2.卸载旧版本的包</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># sudo yum erase docker-common-2:1.12.6-68.gitec8512b.el7.centos.x86_64</span><br></pre></td></tr></table></figure>

<p>3.再次安装docker</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># sudo yum install docker-ce</span><br></pre></td></tr></table></figure>



<p>2.yum安装的时候遇到公钥尚未安装的问题解决</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在 yum install xxxx 命令之后添加 --nogpgcheck 进行跳过公钥检查安装</span><br></pre></td></tr></table></figure>

<p>或者</p>
<p>导入密钥重新安装Docker</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm --<span class="keyword">import</span> http:<span class="comment">//mirrors.163.com/centos/RPM-GPG-KEY-CentOS-7</span></span><br></pre></td></tr></table></figure>



<h1 id="2-容器快速上手"><a href="#2-容器快速上手" class="headerlink" title="2 容器快速上手"></a>2 容器快速上手</h1><p>Docker上手比较简单，按照命令主要分为</p>
<ul>
<li>帮助命令</li>
<li>镜像命令</li>
<li>容器命令</li>
</ul>
<p><img src="/images/2021062902.png" alt="image-20210629222231783"></p>
<h2 id="2-1-帮助命令"><a href="#2-1-帮助命令" class="headerlink" title="2.1 帮助命令"></a>2.1 帮助命令</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker version <span class="comment">#查看Docker版本</span></span><br><span class="line">docker info <span class="comment">#显示Docker系统信息,包括镜像和容器数</span></span><br><span class="line">docker --<span class="built_in">help</span></span><br></pre></td></tr></table></figure>

<h2 id="2-2-镜像命令"><a href="#2-2-镜像命令" class="headerlink" title="2.2 镜像命令"></a>2.2 镜像命令</h2><p><code>docker images</code> 列出本地主机上的镜像</p>
<p><img src="C:%5CUsers%5Cadmin%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210629220324007.png" alt="image-20210629220324007"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">REPOSITORY：表示镜像的仓库源</span><br><span class="line">TAG：镜像的标签</span><br><span class="line">IMAGE ID：镜像ID</span><br><span class="line">CREATED：镜像创建时间</span><br><span class="line">SIZE：镜像大小</span><br></pre></td></tr></table></figure>





<p>收起列表</p>
<ul>
<li><em>视频：</em>2-1 本章介绍 (01:21)</li>
<li><em>视频：</em>2-2 认识一下docker命令行 (07:54)</li>
<li><em>视频：</em>2-3 镜像和容器 (04:26)</li>
<li><em>视频：</em>2-4 创建我们第一个容器 (10:01)</li>
<li><em>视频：</em>2-5 命令行小技巧之批量操作 (04:30)</li>
<li><em>视频：</em>2-6 容器的attached和detached模式 (10:53)</li>
<li><em>视频：</em>2-7 容器的交互式模式 (12:38)</li>
<li><em>视频：</em>2-8 windows是如何运行docker engine的 (06:08)</li>
<li><em>视频：</em>2-9 容器和虚拟机 (14:04)</li>
<li><em>视频：</em>2-10 创建容器时背后到底发生了什么 (04:15)</li>
</ul>
<h1 id="3-镜像的创建管理和发布"><a href="#3-镜像的创建管理和发布" class="headerlink" title="3 镜像的创建管理和发布"></a>3 镜像的创建管理和发布</h1><p>介绍镜像获取的三大主要方式，初步了解Dockerfile和镜像的构建和分享</p>
<p>收起列表</p>
<ul>
<li><em>视频：</em>3-1 镜像的获取方式 (04:23)</li>
<li><em>视频：</em>3-2 镜像的registry介绍 (06:03)</li>
<li><em>视频：</em>3-3 镜像的获取查看和删除 (12:22)</li>
<li><em>视频：</em>3-4 docker镜像的导入导出 (03:05)</li>
<li><em>视频：</em>3-5 Dockerfile的介绍 (08:08)</li>
<li><em>视频：</em>3-6 镜像的构建和分享 (13:02)</li>
<li><em>视频：</em>3-7 通过commit创建镜像 (12:09)</li>
<li><em>视频：</em>3-8 聊聊scratch这个镜像 (07:39)</li>
</ul>
<h1 id="4-Dockerfile指南"><a href="#4-Dockerfile指南" class="headerlink" title="4 Dockerfile指南"></a>4 Dockerfile指南</h1><p>通过示例结合最全的Dockerfile语法讲解，完全掌握Dockerfile语法和重要的最佳实践</p>
<p>收起列表</p>
<ul>
<li><em>视频：</em>4-1 本章介绍 (01:10)</li>
<li><em>视频：</em>4-2 如何选择基础镜像 (10:15)</li>
<li><em>视频：</em>4-3 通过RUN执行指令 (08:43)</li>
<li><em>视频：</em>4-4 文件的复制和目录操作 (12:06)</li>
<li><em>视频：</em>4-5 构建参数和环境变量 (11:04)</li>
<li><em>视频：</em>4-6 容器启动命令CMD (13:12)</li>
<li><em>视频：</em>4-7 容器启动命令ENTRYPOINT (08:31)</li>
<li><em>视频：</em>4-8 一起构建一个Python Flask镜像 (16:10)</li>
<li><em>视频：</em>4-9 Dockerfile技巧-合理使用缓存 (08:40)</li>
<li><em>视频：</em>4-10 Dockerfile技巧——dockerignore (08:05)</li>
<li><em>视频：</em>4-11 Dockerfile技巧——多阶段构建 (10:25)</li>
<li><em>视频：</em>4-12 Dockerfile技巧——尽量使用非root用户 (07:25)</li>
<li><em>视频：</em>4-13 本章总结 (03:36)</li>
</ul>
<h1 id="5-Docker的存储"><a href="#5-Docker的存储" class="headerlink" title="5 Docker的存储"></a>5 Docker的存储</h1><p>数据的持久化如何实现，Volume有哪些类型和使用场景</p>
<p>收起列表</p>
<ul>
<li><em>视频：</em>5-1 本章介绍 (04:34)</li>
<li><em>视频：</em>5-2 数据持久化之Data Volume (17:16)</li>
<li><em>视频：</em>5-3 Data Volume练习之MySQL (06:57)</li>
<li><em>视频：</em>5-4 数据持久化之Bind Mount (10:58)</li>
<li><em>视频：</em>5-5 Bind Mount练习之Docker开发环境(本章未完待续) (12:20)</li>
</ul>
<h1 id="6-Docker的网络"><a href="#6-Docker的网络" class="headerlink" title="6 Docker的网络"></a>6 Docker的网络</h1><p>网络命令空间，端口映射，网络地址转换，路由等概念会在这一章详细的讲解给大家。</p>
<h1 id="7-Docker-compose"><a href="#7-Docker-compose" class="headerlink" title="7 Docker compose"></a>7 Docker compose</h1><p>Docker compose是复杂应用在单机环境下编排的必备工具，本章会通过具体的应用部署演示，覆盖docker compose的基本语法和命令行的使用</p>
<h1 id="8-Docker-swarm"><a href="#8-Docker-swarm" class="headerlink" title="8 Docker swarm"></a>8 Docker swarm</h1><p>作为集群的编排工具，docker swarm虽然不如k8s流行，但是万变不离其宗，掌握其基本原理和使用将大大降低大家学习其它编排工具的难度。</p>
<h1 id="9-Docker-vs-podman"><a href="#9-Docker-vs-podman" class="headerlink" title="9 Docker vs podman"></a>9 Docker vs podman</h1><p>Podman是docker的最有力竞争者，这一章将带领大家快速入门podman，看看podman和docker有什么异同之处和高下之分。</p>
<h1 id="10-Docker的多架构支持"><a href="#10-Docker的多架构支持" class="headerlink" title="10 Docker的多架构支持"></a>10 Docker的多架构支持</h1><p>随着苹果M1芯片的快速发展和普集，arm架构开始进入更多开发者的视野，docker是如何支持多CPU架构的？以及我们如何发布支持多CPU架构的容器镜像呢？这一章将向您解答</p>
<h1 id="11-Git和容器——CI-CD"><a href="#11-Git和容器——CI-CD" class="headerlink" title="11 Git和容器——CI/CD"></a>11 Git和容器——CI/CD</h1><p>这一章我们会关注在应用的部署和运维中，在持续集成和持续部署中结合版本管理和容器技术，同时也会快速的介绍一些自动化运维和监控工具。</p>
<h1 id="12-容器安全"><a href="#12-容器安全" class="headerlink" title="12 容器安全"></a>12 容器安全</h1><p>安全是个大问题，如何确保在生产环境中安全的使用容器呢？本章会为您解开。</p>
<h1 id="13-Docker常用软件安装"><a href="#13-Docker常用软件安装" class="headerlink" title="13 Docker常用软件安装"></a>13 Docker常用软件安装</h1><h2 id="13-1-RabbitMQ安装"><a href="#13-1-RabbitMQ安装" class="headerlink" title="13.1 RabbitMQ安装"></a>13.1 RabbitMQ安装</h2><p> RabbitMQ是基于AMQP的一款消息管理系统。AMQP(Advanced Message Queuing Protocol)，是一个提供消息服务的应用层标准高级消息队列协议，其中RabbitMQ就是基于这种协议的一种实现。</p>
<h3 id="快速构建"><a href="#快速构建" class="headerlink" title="快速构建"></a>快速构建</h3><p>1.docker search选择版本</p>
<p>2.docker pull 下载镜像</p>
<p>3.docker运行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 5672:5672 -p 15672:15672 rabbitmq:版本号</span><br></pre></td></tr></table></figure>

<p><img src="/images/2020072701.png" alt="image-20201219141443802"></p>
<h3 id="可能出现的问题"><a href="#可能出现的问题" class="headerlink" title="可能出现的问题"></a>可能出现的问题</h3><blockquote>
<p>Windows环境下浏览器无法访问虚拟机开的rabbitmq服务</p>
</blockquote>
<p>安装首先确保RabbitMQ的端口等配置正确，另外开放Linux防火墙端口。如果依旧不能访问web界面，那么可能是RabbitMQ没有开启web管理。</p>
<p>只需要通过<code>rabbitmq-plugins list</code>命令列出插件的启用和禁用状态。然后再修改即可。</p>
<h2 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h2><p>1.运行RabbitMQ  　　</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 5672:5672 -p 15672:15672 rabbitmq</span><br></pre></td></tr></table></figure>

<p>2.进入RabbitMQ命令界面　　</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it rabbitmq /bin/bash</span><br></pre></td></tr></table></figure>

<p>3.开启　</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rabbitmq-plugins <span class="built_in">enable</span> rabbitmq_management</span><br></pre></td></tr></table></figure>



<h2 id="13-2-PXC-Percona-XtraDB-Cluster-集群搭建"><a href="#13-2-PXC-Percona-XtraDB-Cluster-集群搭建" class="headerlink" title="13.2 PXC(Percona XtraDB Cluster)集群搭建"></a>13.2 PXC(Percona XtraDB Cluster)集群搭建</h2><p>常见的MySQL集群方案包括：Replication，Percona XtraDB Cluster（PXC）</p>
<blockquote>
<p>MySQL主从复制：<a href="https://www.jianshu.com/p/faf0127f1cb2" target="_blank" rel="noopener">https://www.jianshu.com/p/faf0127f1cb2</a></p>
</blockquote>
<table>
<thead>
<tr>
<th>Replication</th>
<th>PXC</th>
</tr>
</thead>
<tbody><tr>
<td>数据同步是单向的，master负责写，然后异步复制给slave；如果slave写入数据，不会复制给master。</td>
<td>数据同步时双向的，任何一个mysql节点写入数据，都会同步到集群中其它的节点。</td>
</tr>
<tr>
<td>异步复制，从和主无法保证数据的一致性</td>
<td>同步复制，事务在所有集群节点要么同时提交，要么同时不提交</td>
</tr>
</tbody></table>
<p>Replication方案适用于<code>日志，博客</code>这样的网站，存储一些价值较低的内容。</p>
<p>而PXC具备强一致性，数据同步是双向的特点，另外PerconaServer是MySQL改进版，性能提升很大。所以这里我选择的是PXC方案搭建Mysql集群。</p>
<h3 id="13-2-1-环境准备"><a href="#13-2-1-环境准备" class="headerlink" title="13.2.1 环境准备"></a>13.2.1 环境准备</h3><p>Docker的安装与配置非常简单。<br>1.安装docker<br>2.配置docker镜像加速器</p>
<h3 id="13-2-2-PXC集群环境部署"><a href="#13-2-2-PXC集群环境部署" class="headerlink" title="13.2.2 PXC集群环境部署"></a>13.2.2 PXC集群环境部署</h3><h4 id="1-下载镜像"><a href="#1-下载镜像" class="headerlink" title="1.下载镜像"></a>1.下载镜像</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull docker.io/percona/percona-xtradb-cluster</span><br></pre></td></tr></table></figure>

<p><strong>注意：</strong>可以使用<code>docker tag</code>改名，这里我将 docker.io/percona/percona-xtradb-cluster更名为pxc</p>
<h4 id="2-创建内部网络"><a href="#2-创建内部网络" class="headerlink" title="2.创建内部网络"></a>2.创建内部网络</h4><p>出于安全考虑，需要给PXC集群实例创建Docker内部网络</p>
<p>这里我搭建集群使用的是<strong>5节点</strong>，网段可以自己规定</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker network create --subnet=172.10.0.0/24 net1</span><br><span class="line">docker network inspect net1</span><br><span class="line">docker network rm net1</span><br></pre></td></tr></table></figure>

<h4 id="3-创建Docker卷"><a href="#3-创建Docker卷" class="headerlink" title="3.创建Docker卷"></a>3.创建Docker卷</h4><p>容器中的PXC节点映射数据目录的解决方法：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker volume create --name v1</span><br><span class="line">docker volume create --name v2</span><br><span class="line">docker volume create --name v3</span><br><span class="line">docker volume create --name v4</span><br><span class="line">docker volume create --name v5</span><br></pre></td></tr></table></figure>

<p>查看docker卷信息：<code>docker inspect v1</code></p>
<h4 id="4-创建PXC容器"><a href="#4-创建PXC容器" class="headerlink" title="4.创建PXC容器"></a>4.创建PXC容器</h4><p>5个PXC容器</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 3306:3306 -e MYSQL_ROOT_PASSWORD=123456 -e CLUSTER_NAME=PXC -e XTRABACKUP_PASSWORD=123456 -v v1:/var/lib/mysql --privileged --name=node1 --net=net1 --ip 172.10.0.2 pxc </span><br><span class="line"></span><br><span class="line">docker run -d -p 3307:3306 -e MYSQL_ROOT_PASSWORD=123456 -e CLUSTER_NAME=PXC -e XTRABACKUP_PASSWORD=123456 -e CLUSTER_JOIN=node1 -v v2:/var/lib/mysql --privileged --name=node2 --net=net1 --ip 172.10.0.3 pxc</span><br><span class="line"></span><br><span class="line">docker run -d -p 3308:3306 -e MYSQL_ROOT_PASSWORD=123456 -e CLUSTER_NAME=PXC -e XTRABACKUP_PASSWORD=123456 -e CLUSTER_JOIN=node1 -v v3:/var/lib/mysql --privileged --name=node3 --net=net1 --ip 172.10.0.4 pxc </span><br><span class="line"></span><br><span class="line">docker run -d -p 3309:3306 -e MYSQL_ROOT_PASSWORD=123456 -e CLUSTER_NAME=PXC -e XTRABACKUP_PASSWORD=123456 -e CLUSTER_JOIN=node1 -v v4:/var/lib/mysql --privileged --name=node4 --net=net1 --ip 172.10.0.5 pxc</span><br><span class="line"></span><br><span class="line">docker run -d -p 3310:3306 -e MYSQL_ROOT_PASSWORD=123456 -e CLUSTER_NAME=PXC -e XTRABACKUP_PASSWORD=123456 -e CLUSTER_JOIN=node1 -v v5:/var/lib/mysql --privileged --name=node5 --net=net1 --ip 172.10.0.6 pxc</span><br></pre></td></tr></table></figure>

<h3 id="13-2-3-验证PCX集群"><a href="#13-2-3-验证PCX集群" class="headerlink" title="13.2.3 验证PCX集群"></a>13.2.3 验证PCX集群</h3><p>在数据库中创建5个DB：</p>
<p><img src="/images/2020110201.png" alt="image"></p>
<p>在DB1中新建test数据库并创建student表：</p>
<p><img src="/images/2020110202.png" alt="image-20201102100820614"></p>
<p>刷新之后，可以看到DB2,DB3,DB4,DB5全部同步到与DB1一致</p>
<p><img src="/images/2020110203.png" alt="image-20201102100858654"></p>
<h3 id="13-2-4-数据库负载的配置"><a href="#13-2-4-数据库负载的配置" class="headerlink" title="13.2.4 数据库负载的配置"></a>13.2.4 数据库负载的配置</h3><p>数据库负载均衡的必要性：</p>
<p>虽然搭建了集群，但是不使用数据库负载均衡，单节点处理所有请求，会暴露负载高，性能差的问题</p>
<p>这里可以使用<strong>Haproxy</strong>做负载均衡，将请求均匀的分发给每个节点，单节点负载会轻松很多。</p>
<h4 id="1-haproxy的下载"><a href="#1-haproxy的下载" class="headerlink" title="1.haproxy的下载"></a>1.haproxy的下载</h4><p><code>docker pull haproxy</code></p>
<h4 id="2-创建haproxy配置文件"><a href="#2-创建haproxy配置文件" class="headerlink" title="2.创建haproxy配置文件"></a>2.创建haproxy配置文件</h4><blockquote>
<p>配置参考：<a href="http://zhangge.net/5125.html" target="_blank" rel="noopener">http://zhangge.net/5125.html</a></p>
</blockquote>
<p>在<code>/home/soft/haproxy/</code>目录下创建haproxy.cfg文件</p>
<p>haproxy.cfg</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">global</span><br><span class="line">	#工作目录</span><br><span class="line">	chroot &#x2F;usr&#x2F;local&#x2F;etc&#x2F;haproxy</span><br><span class="line">	#日志文件，使用rsyslog服务中local5日志设备（&#x2F;var&#x2F;log&#x2F;local5），等级info</span><br><span class="line">	log 127.0.0.1 local5 info</span><br><span class="line">	#守护进程运行</span><br><span class="line">	daemon</span><br><span class="line"></span><br><span class="line">defaults</span><br><span class="line">	log global</span><br><span class="line">	mode http</span><br><span class="line">	#日志格式</span><br><span class="line">	option httplog</span><br><span class="line">	#日志中不记录负载均衡的心跳检测记录</span><br><span class="line">	option dontlognull</span><br><span class="line">	#连接超时（毫秒）</span><br><span class="line">	timeout connect 5000</span><br><span class="line">	#客户端超时（毫秒）</span><br><span class="line">	timeout client 50000</span><br><span class="line">	#服务器超时（毫秒）</span><br><span class="line">	timeout server 50000</span><br><span class="line"></span><br><span class="line">#监控界面</span><br><span class="line">listen admin_stats</span><br><span class="line">	#监控界面的访问的IP和端口</span><br><span class="line">	bind 0.0.0.0:8888</span><br><span class="line">	#访问协议</span><br><span class="line">	mode http</span><br><span class="line">	#URI相对地址</span><br><span class="line">	stats uri &#x2F;dbs</span><br><span class="line">	#统计报告格式</span><br><span class="line">	stats realm     Global\ statistics</span><br><span class="line">	#登陆帐户信息</span><br><span class="line">	stats auth  admin:123456</span><br><span class="line"> #数据库负载均衡</span><br><span class="line"> listen  proxy-mysql</span><br><span class="line">	#访问的IP和端口</span><br><span class="line">	bind  0.0.0.0:3306</span><br><span class="line">	#网络协议</span><br><span class="line">	mode  tcp</span><br><span class="line">	#负载均衡算法（轮询算法）</span><br><span class="line">	#轮询算法：roundrobin</span><br><span class="line">	#权重算法：static-rr</span><br><span class="line">	#最少连接算法：leastconn</span><br><span class="line">	#请求源IP算法：source</span><br><span class="line">	balance  roundrobin</span><br><span class="line">	#日志格式</span><br><span class="line">	option  tcplog</span><br><span class="line">   	#在MySQL中创建一个没有权限的haproxy用户，密码为空。Haproxy使用这个账户对MySQL数据库心跳检测</span><br><span class="line">        option  mysql-check user haproxy</span><br><span class="line">        server  MySQL_1 172.10.1.2:3306 check weight 1 maxconn 2000</span><br><span class="line">        server  MySQL_2 172.10.1.3:3306 check weight 1 maxconn 2000</span><br><span class="line">        server  MySQL_3 172.10.1.4:3306 check weight 1 maxconn 2000</span><br><span class="line">        server  MySQL_4 172.10.1.5:3306 check weight 1 maxconn 2000</span><br><span class="line">        server  MySQL_5 172.10.1.6:3306 check weight 1 maxconn 2000</span><br><span class="line">	#使用keepalive检测死链</span><br><span class="line">	option  tcpka</span><br></pre></td></tr></table></figure>



<h4 id="4-实例化haproxy"><a href="#4-实例化haproxy" class="headerlink" title="4.实例化haproxy"></a>4.实例化haproxy</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it -d -p 4001:8888 -p 4002:3306 -v /home/soft/haproxy:/usr/<span class="built_in">local</span>/etc/haproxy --name h1 --privileged --net=net1 --ip 172.10.0.7 haproxy</span><br></pre></td></tr></table></figure>

<h4 id="5-登陆到交互容器里"><a href="#5-登陆到交互容器里" class="headerlink" title="5.登陆到交互容器里"></a>5.登陆到交互容器里</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it h1 bash</span><br><span class="line">haproxy -f /usr/<span class="built_in">local</span>/etc/haproxy/haproxy.cfg</span><br></pre></td></tr></table></figure>

<h4 id="6-测试"><a href="#6-测试" class="headerlink" title="6.测试"></a>6.测试</h4><p><img src="/images/2020110204.png" alt="image-20201102120345130"></p>
<p>首页展示：</p>
<p><img src="/images/2020110205.png" alt="image-20201102120404832"></p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Docker/" rel="tag"><i class="fa fa-tag"></i> Docker</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/06/10/FastDFS%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8/" rel="prev" title="FastDFS文件服务器">
      <i class="fa fa-chevron-left"></i> FastDFS文件服务器
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#1-Docker的安装和介绍"><span class="nav-text">1 Docker的安装和介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-1-Docker简介"><span class="nav-text">1.1 Docker简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-2-Linux环境下安装docker"><span class="nav-text">1.2 Linux环境下安装docker</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-3-配置镜像加速"><span class="nav-text">1.3 配置镜像加速</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-4-可能遇到的问题"><span class="nav-text">1.4 可能遇到的问题</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2-容器快速上手"><span class="nav-text">2 容器快速上手</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#2-1-帮助命令"><span class="nav-text">2.1 帮助命令</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-2-镜像命令"><span class="nav-text">2.2 镜像命令</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3-镜像的创建管理和发布"><span class="nav-text">3 镜像的创建管理和发布</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4-Dockerfile指南"><span class="nav-text">4 Dockerfile指南</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5-Docker的存储"><span class="nav-text">5 Docker的存储</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#6-Docker的网络"><span class="nav-text">6 Docker的网络</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#7-Docker-compose"><span class="nav-text">7 Docker compose</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#8-Docker-swarm"><span class="nav-text">8 Docker swarm</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#9-Docker-vs-podman"><span class="nav-text">9 Docker vs podman</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#10-Docker的多架构支持"><span class="nav-text">10 Docker的多架构支持</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#11-Git和容器——CI-CD"><span class="nav-text">11 Git和容器——CI&#x2F;CD</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#12-容器安全"><span class="nav-text">12 容器安全</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#13-Docker常用软件安装"><span class="nav-text">13 Docker常用软件安装</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#13-1-RabbitMQ安装"><span class="nav-text">13.1 RabbitMQ安装</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#快速构建"><span class="nav-text">快速构建</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#可能出现的问题"><span class="nav-text">可能出现的问题</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#解决方法"><span class="nav-text">解决方法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#13-2-PXC-Percona-XtraDB-Cluster-集群搭建"><span class="nav-text">13.2 PXC(Percona XtraDB Cluster)集群搭建</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#13-2-1-环境准备"><span class="nav-text">13.2.1 环境准备</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#13-2-2-PXC集群环境部署"><span class="nav-text">13.2.2 PXC集群环境部署</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-下载镜像"><span class="nav-text">1.下载镜像</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-创建内部网络"><span class="nav-text">2.创建内部网络</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-创建Docker卷"><span class="nav-text">3.创建Docker卷</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-创建PXC容器"><span class="nav-text">4.创建PXC容器</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#13-2-3-验证PCX集群"><span class="nav-text">13.2.3 验证PCX集群</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#13-2-4-数据库负载的配置"><span class="nav-text">13.2.4 数据库负载的配置</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-haproxy的下载"><span class="nav-text">1.haproxy的下载</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-创建haproxy配置文件"><span class="nav-text">2.创建haproxy配置文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-实例化haproxy"><span class="nav-text">4.实例化haproxy</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-登陆到交互容器里"><span class="nav-text">5.登陆到交互容器里</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-测试"><span class="nav-text">6.测试</span></a></li></ol></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="liubin"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">liubin</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">101</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">66</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">95</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/liuurick" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;liuurick" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:liuurick@gmail.com" title="E-Mail → mailto:liuurick@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/liuurick" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;liuurick" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://instagram.com/liuurick" title="Instagram → https:&#x2F;&#x2F;instagram.com&#x2F;liuurick" rel="noopener" target="_blank"><i class="fab fa-instagram fa-fw"></i>Instagram</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">liubin</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
