<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="MySQL的深入学习主要分为5个部分，分别是：  MySQL的架构介绍 索引优化分析 查询截取分析 MySQL锁机制 主从复制">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL高级">
<meta property="og:url" content="http://yoursite.com/2020/11/20/MySQL%E9%AB%98%E7%BA%A7/index.html">
<meta property="og:site_name" content="lb Blog">
<meta property="og:description" content="MySQL的深入学习主要分为5个部分，分别是：  MySQL的架构介绍 索引优化分析 查询截取分析 MySQL锁机制 主从复制">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="c:%5CUsers%5Cadmin%5CDesktop%5Cblog%5Csource%5Cimages%5C2020112201.png">
<meta property="og:image" content="c:%5CUsers%5Cadmin%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201122210059330.png">
<meta property="og:image" content="c:%5CUsers%5Cadmin%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201122210437197.png">
<meta property="og:image" content="c:%5CUsers%5Cadmin%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201122204405232.png">
<meta property="og:image" content="c:%5CUsers%5Cadmin%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201122210850349.png">
<meta property="og:image" content="c:%5CUsers%5Cadmin%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201122211604756.png">
<meta property="og:image" content="c:%5CUsers%5Cadmin%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201122211244330.png">
<meta property="og:image" content="c:%5CUsers%5Cadmin%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201122212503860.png">
<meta property="og:image" content="c:%5CUsers%5Cadmin%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201122213038046.png">
<meta property="og:image" content="c:%5CUsers%5Cadmin%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201122220007001.png">
<meta property="og:image" content="c:%5CUsers%5Cadmin%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201122212059724.png">
<meta property="og:image" content="c:%5CUsers%5Cadmin%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201123095017572.png">
<meta property="og:image" content="https://img2018.cnblogs.com/blog/1491092/201906/1491092-20190604210526387-1627086664.png">
<meta property="og:image" content="c:%5CUsers%5Cadmin%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201123100931321.png">
<meta property="og:image" content="https://images2015.cnblogs.com/blog/1054685/201706/1054685-20170626154318664-711238691.jpg">
<meta property="og:image" content="https://images2015.cnblogs.com/blog/1054685/201706/1054685-20170626113414446-2016950911.jpg">
<meta property="og:image" content="https://images2015.cnblogs.com/blog/1054685/201706/1054685-20170627085051383-985324526.png">
<meta property="article:published_time" content="2020-11-20T05:55:41.000Z">
<meta property="article:modified_time" content="2020-11-23T11:20:51.065Z">
<meta property="article:author" content="liubin">
<meta property="article:tag" content="MySQL高级">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="c:%5CUsers%5Cadmin%5CDesktop%5Cblog%5Csource%5Cimages%5C2020112201.png">

<link rel="canonical" href="http://yoursite.com/2020/11/20/MySQL%E9%AB%98%E7%BA%A7/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>MySQL高级 | lb Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">lb Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/11/20/MySQL%E9%AB%98%E7%BA%A7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="liubin">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="lb Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          MySQL高级
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-11-20 13:55:41" itemprop="dateCreated datePublished" datetime="2020-11-20T13:55:41+08:00">2020-11-20</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MySQL/" itemprop="url" rel="index"><span itemprop="name">MySQL</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>MySQL的深入学习主要分为5个部分，分别是：</p>
<ul>
<li>MySQL的架构介绍</li>
<li>索引优化分析</li>
<li>查询截取分析</li>
<li>MySQL锁机制</li>
<li>主从复制</li>
</ul>
<a id="more"></a>

<h1 id="一-mysql的架构介绍"><a href="#一-mysql的架构介绍" class="headerlink" title="一.mysql的架构介绍"></a>一.mysql的架构介绍</h1><h2 id="1-MysqlLinux版本的安装–mysql5-5"><a href="#1-MysqlLinux版本的安装–mysql5-5" class="headerlink" title="1. MysqlLinux版本的安装–mysql5.5"></a>1. MysqlLinux版本的安装–mysql5.5</h2><h3 id="1-1-下载地址"><a href="#1-1-下载地址" class="headerlink" title="1.1 下载地址"></a>1.1 下载地址</h3><p><a href="https://dev.mysql.com/downloads/mysql/" target="_blank" rel="noopener">https://dev.mysql.com/downloads/mysql/</a></p>
<h3 id="1-2-检查当前系统是否安装过mysql"><a href="#1-2-检查当前系统是否安装过mysql" class="headerlink" title="1.2 检查当前系统是否安装过mysql"></a>1.2 检查当前系统是否安装过mysql</h3><p>查询命令：<code>rpm -qa|grep -i mysql</code></p>
<p>删除命令：<code>rpm -e RPM软件包名（改名字是上一个命令查出来的名字）</code></p>
<h3 id="1-3-安装mysql服务端-注意提示-与客户端"><a href="#1-3-安装mysql服务端-注意提示-与客户端" class="headerlink" title="1.3 安装mysql服务端(注意提示)与客户端"></a>1.3 安装mysql服务端(注意提示)与客户端</h3><p>安装路径：</p>
<p><img src="C:%5CUsers%5Cadmin%5CDesktop%5Cblog%5Csource%5Cimages%5C2020112201.png" alt="image-20201122172644460"></p>
<p>上传并解压文件：</p>
<p><code>tar -xvf MySQL-5.5.62-1.el7.x86_64.rpm-bundle.tar</code></p>
<p><img src="C:%5CUsers%5Cadmin%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201122210059330.png" alt="image-20201122210059330"></p>
<p>安装：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rpm -ivh MySQL-server-5.5.62-1.el7.x86_64.rpm</span><br><span class="line">rpm -ivh MySQL-client-5.5.62-1.el7.x86_64.rpm</span><br></pre></td></tr></table></figure>

<p>注意：这里可能会出现错误：</p>
<blockquote>
<p>conflicts with file from package mariadb-libs-1:5.5.56-2.el7.x86_641</p>
</blockquote>
<p><img src="C:%5CUsers%5Cadmin%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201122210437197.png" alt="image-20201122210437197"></p>
<p>与mariadb冲突，删除mariadb即可！</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -e mariadb-libs-1:5.5.65-1.el7.x86_64 --nodeps</span><br></pre></td></tr></table></figure>



<h3 id="1-4-查看Mysql安装时创建的mysql用户和mysql组"><a href="#1-4-查看Mysql安装时创建的mysql用户和mysql组" class="headerlink" title="1.4 查看Mysql安装时创建的mysql用户和mysql组"></a>1.4 查看Mysql安装时创建的mysql用户和mysql组</h3><p><img src="C:%5CUsers%5Cadmin%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201122204405232.png" alt="image-20201122204405232"></p>
<p>或者也可以执行mysqladmin –version 命令，类似java -version，如果可以查看消息，说明成功</p>
<p><img src="C:%5CUsers%5Cadmin%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201122210850349.png" alt="image-20201122210850349"></p>
<h3 id="1-5-mysql服务的启动和停止"><a href="#1-5-mysql服务的启动和停止" class="headerlink" title="1.5 mysql服务的启动和停止"></a>1.5 mysql服务的启动和停止</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">service mysql start</span><br><span class="line">service mysql stop</span><br></pre></td></tr></table></figure>

<p>查看进程：</p>
<p><img src="C:%5CUsers%5Cadmin%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201122211604756.png" alt="image-20201122211604756"></p>
<p><strong>注意：</strong>可能会报下面的错误</p>
<blockquote>
<p>Starting MySQL. ERROR! The server quit without updating PID file (/var/lib/mysql/localhost.localdomain.pid).</p>
</blockquote>
<p><img src="C:%5CUsers%5Cadmin%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201122211244330.png" alt="image-20201122211244330"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">解决步骤：</span><br><span class="line">yum -y install autoconf</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;mysql_install_db --user&#x3D;mysql</span><br><span class="line">service mysql start</span><br></pre></td></tr></table></figure>

<p>解答参考页面：<a href="https://www.cnblogs.com/weibanggang/p/11230528.html" target="_blank" rel="noopener">https://www.cnblogs.com/weibanggang/p/11230528.html</a></p>
<h3 id="1-6-mysql的ROOT密码设置"><a href="#1-6-mysql的ROOT密码设置" class="headerlink" title="1.6 mysql的ROOT密码设置"></a>1.6 mysql的ROOT密码设置</h3><p>首次会直接连接成功，因为mysql默认没有密码。</p>
<p>修改密码可以按照Service中的提示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;usr&#x2F;bin&#x2F;mysqladmin -u root password 123456</span><br></pre></td></tr></table></figure>

<p><img src="C:%5CUsers%5Cadmin%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201122212503860.png" alt="image-20201122212503860"></p>
<h3 id="1-7-自启动mysql服务"><a href="#1-7-自启动mysql服务" class="headerlink" title="1.7 自启动mysql服务"></a>1.7 自启动mysql服务</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chkconfig mysql on</span><br></pre></td></tr></table></figure>

<p>或者</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ntsysv</span><br></pre></td></tr></table></figure>



<p><code>chkconfig --list|grep mysql</code></p>
<p><img src="C:%5CUsers%5Cadmin%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201122213038046.png" alt="image-20201122213038046"></p>
<h3 id="1-8-修改配置文件位置"><a href="#1-8-修改配置文件位置" class="headerlink" title="1.8 修改配置文件位置"></a>1.8 修改配置文件位置</h3><p>5.5版本：<code>cp /usr/share/mysql/my-huge.cnf /etc/my.cnf</code></p>
<p>5.6版本：<code>cp /usr/share/mysql/my-default.cnf /etc/my.cnf</code></p>
<h3 id="1-9-修改字符集和数据存储路径"><a href="#1-9-修改字符集和数据存储路径" class="headerlink" title="1.9 修改字符集和数据存储路径"></a>1.9 修改字符集和数据存储路径</h3><p>查看字符集：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">show variables like &#39;%char%&#39;;</span><br><span class="line">show variables like &#39;%character%&#39;;</span><br></pre></td></tr></table></figure>

<p><img src="C:%5CUsers%5Cadmin%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201122220007001.png" alt="image-20201122220007001"></p>
<p>修改my.cnf文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">[client]</span><br><span class="line">#password	&#x3D; your_password</span><br><span class="line">port		&#x3D; 3306</span><br><span class="line">socket		&#x3D; &#x2F;var&#x2F;lib&#x2F;mysql&#x2F;mysql.sock</span><br><span class="line"></span><br><span class="line">default-character-set &#x3D; utf8mb4</span><br><span class="line"></span><br><span class="line"># Here follows entries for some specific programs</span><br><span class="line"></span><br><span class="line"># The MySQL server</span><br><span class="line">[mysqld]</span><br><span class="line">port		&#x3D; 3306</span><br><span class="line"></span><br><span class="line">character-set-client-handshake &#x3D; FALSE</span><br><span class="line">character-set-server &#x3D; utf8mb4</span><br><span class="line">collation-server &#x3D; utf8mb4_general_ci</span><br><span class="line"></span><br><span class="line">socket		&#x3D; &#x2F;var&#x2F;lib&#x2F;mysql&#x2F;mysql.sock</span><br><span class="line">skip-external-locking</span><br><span class="line">key_buffer_size &#x3D; 384M</span><br><span class="line">max_allowed_packet &#x3D; 1M</span><br><span class="line">table_open_cache &#x3D; 512</span><br><span class="line">sort_buffer_size &#x3D; 2M</span><br><span class="line">read_buffer_size &#x3D; 2M</span><br><span class="line">read_rnd_buffer_size &#x3D; 8M</span><br><span class="line">myisam_sort_buffer_size &#x3D; 64M</span><br><span class="line">thread_cache_size &#x3D; 8</span><br><span class="line">query_cache_size &#x3D; 32M</span><br><span class="line"># Try number of CPU&#39;s*2 for thread_concurrency</span><br><span class="line">thread_concurrency &#x3D; 8</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">log-bin&#x3D;mysql-bin</span><br><span class="line"></span><br><span class="line"># required unique id between 1 and 2^32 - 1</span><br><span class="line"># defaults to 1 if master-host is not set</span><br><span class="line"># but will not function as a master if omitted</span><br><span class="line">server-id	&#x3D; 1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[mysqldump]</span><br><span class="line">quick</span><br><span class="line">max_allowed_packet &#x3D; 16M</span><br><span class="line"></span><br><span class="line">[mysql]</span><br><span class="line">no-auto-rehash</span><br><span class="line"></span><br><span class="line">default-character-set &#x3D; utf8mb4</span><br><span class="line"></span><br><span class="line"># Remove the next comment character if you are not familiar with SQL</span><br><span class="line">#safe-updates</span><br><span class="line"></span><br><span class="line">[myisamchk]</span><br><span class="line">key_buffer_size &#x3D; 256M</span><br><span class="line">sort_buffer_size &#x3D; 256M</span><br><span class="line">read_buffer &#x3D; 2M</span><br><span class="line">write_buffer &#x3D; 2M</span><br><span class="line"></span><br><span class="line">[mysqlhotcopy]</span><br><span class="line">interactive-timeout</span><br></pre></td></tr></table></figure>

<p>修改完成之后重启mysql服务</p>
<h3 id="1-10-Mysql的安装位置"><a href="#1-10-Mysql的安装位置" class="headerlink" title="1.10 Mysql的安装位置"></a>1.10 Mysql的安装位置</h3><p>在linux下查看安装目录 ps -ef|grep mysql</p>
<p><img src="C:%5CUsers%5Cadmin%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201122212059724.png" alt="image-20201122212059724"></p>
<h2 id="2-Mysql配置文件"><a href="#2-Mysql配置文件" class="headerlink" title="2.Mysql配置文件"></a>2.Mysql配置文件</h2><h3 id="2-1-二进制日志log-bin"><a href="#2-1-二进制日志log-bin" class="headerlink" title="2.1 二进制日志log-bin"></a>2.1 二进制日志log-bin</h3><p>主要用作主重复制</p>
<h3 id="2-2-错误日志log-error"><a href="#2-2-错误日志log-error" class="headerlink" title="2.2 错误日志log-error"></a>2.2 错误日志log-error</h3><p>默认是关闭的,记录严重的警告和错误信息,每次启动和关闭的详细信息等.</p>
<h3 id="2-3-查询日志log"><a href="#2-3-查询日志log" class="headerlink" title="2.3 查询日志log"></a>2.3 查询日志log</h3><p>默认关闭,记录查询的sql语句，如果开启会减低mysql的整体性能，因为记录日志也是需要消耗系统资源的</p>
<h3 id="2-4-数据文件"><a href="#2-4-数据文件" class="headerlink" title="2.4 数据文件"></a>2.4 数据文件</h3><p>在Windows下，D:\ProgramFiles\MySQL\MySQLServer5.5\data目录下可以挑选很多库；</p>
<p>在Linux下，看看当前系统中的全部库后再进去（默认路径：/var/lib/mysql）。    </p>
<p><strong>数据文件：</strong>    </p>
<p>​    frm文件：存放表结构</p>
<p>​    myd文件：存放表数据</p>
<p>​    myi文件：存放表索引</p>
<h3 id="2-5-如何配置"><a href="#2-5-如何配置" class="headerlink" title="2.5 如何配置"></a>2.5 如何配置</h3><p>windows：my.ini文件</p>
<p>Linux：/etc/my.cnf文件</p>
<h2 id="3-Mysql逻辑架构介绍"><a href="#3-Mysql逻辑架构介绍" class="headerlink" title="3.Mysql逻辑架构介绍"></a>3.Mysql逻辑架构介绍</h2><p>和其它数据库相比，MySQL有点与众不同，它的架构可以在多种不同场景中应用并发挥良好作用。主要体现在存储引擎的架构上，插件式的存储引擎架构将查询处理和其它的系统任务以及数据的存储提取相分离。这种架构可以根据业务的需求和实际需要选择合适的存储引擎。</p>
<p><img src="C:%5CUsers%5Cadmin%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201123095017572.png" alt="image-20201123095017572"></p>
<h3 id="3-1-连接层"><a href="#3-1-连接层" class="headerlink" title="3.1 连接层"></a>3.1 连接层</h3><p>最上层是一些客户端和连接服务，包含本地sock通信和大多数基于客户端/服务端工具实现的类似于tcp/ip的通信。主要完成一些类似于连接处理、授权认证、及相关的安全方案。在该层上引入了线程池的概念，为通过认证安全接入的客户端提供线程。同样在该层上可以实现基于SSL的安全链接。服务器也会为安全接入的每个客户端验证它所具有的操作权限。</p>
<p><strong>Connectors：</strong>指的是不同语言中与SQL的交互</p>
<p><strong>Connection Pool</strong>: 连接池<br>管理缓冲用户连接，线程处理等需要缓存的需求。<br>负责监听对 MySQL Server 的各种请求，接收连接请求，转发所有连接请求到线程管理模块。每一个连接上 MySQL Server 的客户端请求都会被分配（或创建）一个连接线程为其单独服务。而连接线程的主要工作就是负责 MySQL Server 与客户端的通信，接受客户端的命令请求，传递 Server 端的结果信息等。线程管理模块则负责管理维护这些连接线程。包括线程的创建，线程的 cache 等。</p>
<h3 id="3-2-服务层"><a href="#3-2-服务层" class="headerlink" title="3.2 服务层"></a>3.2 服务层</h3><p>第二层架构主要完成大多数的核心服务功能，如SQL接口，并完成缓存的查询，SQL的分析和优化及部分内置函数的执行，所有跨存储引擎的功能也在这一层实现，如过程，函数等。在该层，服务器会解析查询并创建相应的内部解析树，并对其完成相应的优化，如确定查询表的顺序，是否利用索引等，最后生成相应的执行操作。如果是select语句，服务器还会查询内部的缓存，如果缓存空间足够大，这样在解决大量读操作的环境中能够很好的提升系统的性能。</p>
<p><strong>Management Serveices &amp; Utilities： *<em>系统管理和控制工具<br>*</em>Connection Pool: 连接池</strong>。管理缓冲用户连接，线程处理等需要缓存的需求。<br>负责监听对 MySQL Server 的各种请求，接收连接请求，转发所有连接请求到线程管理模块。每一个连接上 MySQL Server 的客户端请求都会被分配（或创建）一个连接线程为其单独服务。而连接线程的主要工作就是负责 MySQL Server 与客户端的通信，接受客户端的命令请求，传递 Server 端的结果信息等。线程管理模块则负责管理维护这些连接线程。包括线程的创建，线程的 cache 等。<br><strong>SQL Interface: SQL接口</strong><br>接受用户的SQL命令，并且返回用户需要查询的结果。比如select from就是调用SQL Interface<br><strong>Parser: 解析器</strong><br>SQL命令传递到解析器的时候会被解析器验证和解析。解析器是由Lex和YACC实现的，是一个很长的脚本。<br>在 MySQL中我们习惯将所有 Client 端发送给 Server 端的命令都称为 query ，在 MySQL Server 里面，连接线程接收到客户端的一个 Query 后，会直接将该 query 传递给专门负责将各种 Query 进行分类然后转发给各个对应的处理模块。</p>
<p>​        主要功能：<br>​        a . 将SQL语句进行语义和语法的分析，分解成数据结构，然后按照不同的操作类型进行分类，然后做出针对性的转发到后续步骤，以后SQL语句的传递和处理就是基于这个结构的。<br>​        b.  如果在分解构成中遇到错误，那么就说明这个sql语句是不合理的</p>
<p><strong>Optimizer: 查询优化器</strong></p>
<p>SQL语句在查询之前会使用查询优化器对查询进行优化。就是优化客户端请求的 query（sql语句） ，根据客户端请求的 query 语句，和数据库中的一些统计信息，在一系列算法的基础上进行分析，得出一个最优的策略，告诉后面的程序如何取得这个 query 语句的结果<br>他使用的是“<strong>选取-投影-联接</strong>”策略进行查询。<br>       用一个例子就可以理解： select uid,name from user where gender = 1;<br>       这个select 查询先根据where 语句进行选取，而不是先将表全部查询出来以后再进行gender过滤<br>       这个select查询先根据uid和name进行属性投影，而不是将属性全部取出以后再进行过滤<br>       将这两个查询条件联接起来生成最终查询结果</p>
<p><strong>Cache和Buffer： 查询缓存</strong><br>他的主要功能是将客户端提交 给MySQL 的 Select 类 query 请求的返回结果集 cache 到内存中，与该 query 的一个 hash 值 做一个对应。该 Query 所取数据的基表发生任何数据的变化之后， MySQL 会自动使该 query 的Cache 失效。在读写比例非常高的应用系统中， Query Cache 对性能的提高是非常显著的。当然它对内存的消耗也是非常大的。<br>如果查询缓存有命中的查询结果，查询语句就可以直接去查询缓存中取数据。这个缓存机制是由一系列小缓存组成的。比如表缓存，记录缓存，key缓存，权限缓存等</p>
<h3 id="3-3-引擎层"><a href="#3-3-引擎层" class="headerlink" title="3.3 引擎层"></a>3.3 引擎层</h3><p>存储引擎层，存储引擎真正的负责了MySQL中数据的存储和提取，服务器通过API与存储引擎进行通信。不同的存储引擎具有的功能不同，这样我们可以根据自己的实际需要进行选取。</p>
<p><strong>存储引擎接口模块</strong>：可以说是 MySQL 数据库中最有特色的一点了。目前各种数据库产品中，基本上只有 MySQL 可以实现其底层数据存储引擎的插件式管理。这个模块实际上只是 一个抽象类，但正是因为它成功地将各种数据处理高度抽象化，才成就了今天 MySQL 可插拔存储引擎的特色。<br>     从上图可以看出，MySQL区别于其他数据库的最重要的特点就是其插件式的表存储引擎。MySQL插件式的存储引擎架构提供了一系列标准的管理和服务支持，这些标准与存储引擎本身无关，可能是每个数据库系统本身都必需的，如SQL分析器和优化器等，而存储引擎是底层物理结构的实现，每个存储引擎开发者都可以按照自己的意愿来进行开发。<br>    <strong>注意：</strong>存储引擎是基于表的，而不是数据库。</p>
<h3 id="3-4-存储层"><a href="#3-4-存储层" class="headerlink" title="3.4 存储层"></a>3.4 存储层</h3><p>数据存储层，主要是将数据存储在运行于裸设备的文件系统之上，并完成与存储引擎的交互。</p>
<p><strong>查询说明：</strong></p>
<p><strong><img src="https://img2018.cnblogs.com/blog/1491092/201906/1491092-20190604210526387-1627086664.png" alt="img"></strong></p>
<p>首先，mysql的查询流程大致是：</p>
<ul>
<li><p>mysql客户端通过协议与mysql服务器建连接，发送查询语句，先检查查询缓存，如果命中(一模一样的sql才能命中)，直接返回结果，否则进行语句解析,也就是说，在解析查询之前，服务器会先访问查询缓存(query cache)——它存储SELECT语句以及相应的查询结果集。如果某个查询结果已经位于缓存中，服务器就不会再对查询进行解析、优化、以及执行。它仅仅将缓存中的结果返回给用户即可，这将大大提高系统的性能。</p>
</li>
<li><p>语法解析器和预处理：首先mysql通过关键字将SQL语句进行解析，并生成一颗对应的“解析树”。mysql解析器将使用mysql语法规则验证和解析查询；预处理器则根据一些mysql规则进一步检查解析数是否合法。</p>
</li>
<li><p>查询优化器当解析树被认为是合法的了，并且由优化器将其转化成执行计划。一条查询可以有很多种执行方式，最后都返回相同的结果。优化器的作用就是找到这其中最好的执行计划。。</p>
</li>
<li><p>然后，mysql默认使用的BTREE索引，并且一个大致方向是:无论怎么折腾sql，至少在目前来说，mysql最多只用到表中的一个索引。</p>
</li>
</ul>
<h2 id="4-Mysql存储引擎"><a href="#4-Mysql存储引擎" class="headerlink" title="4.Mysql存储引擎"></a>4.Mysql存储引擎</h2><p>常用命令：</p>
<p>查看mysql现在提供什么存储引擎</p>
<p><code>show engines;</code></p>
<p>查看mysql当前默认的存储引擎</p>
<p><code>show variables like &#39;%storage_engine%&#39;</code></p>
<p>MyISAM和InnoDB对比：</p>
<p><img src="C:%5CUsers%5Cadmin%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201123100931321.png" alt="image-20201123100931321"></p>
<h1 id="二-索引优化分析"><a href="#二-索引优化分析" class="headerlink" title="二.索引优化分析"></a>二.索引优化分析</h1><h2 id="1-性能下降SQL慢-，执行时间长-，等待时间长的原因分析"><a href="#1-性能下降SQL慢-，执行时间长-，等待时间长的原因分析" class="headerlink" title="1.性能下降SQL慢 ，执行时间长 ，等待时间长的原因分析"></a>1.性能下降SQL慢 ，执行时间长 ，等待时间长的原因分析</h2><p>主要有以下原因：</p>
<ul>
<li><p>查询语句写的烂</p>
</li>
<li><p>索引失效</p>
<p>​    单值索引/复合索引失效</p>
</li>
<li><p>关联查询太多join(设计缺陷或不得已的需求)</p>
</li>
<li><p>服务器调优及各个参数设置(缓冲\线程数等)</p>
</li>
</ul>
<h2 id="2-常见通用的join查询"><a href="#2-常见通用的join查询" class="headerlink" title="2.常见通用的join查询"></a>2.常见通用的join查询</h2><h3 id="2-1-SQL执行顺序"><a href="#2-1-SQL执行顺序" class="headerlink" title="2.1 SQL执行顺序"></a>2.1 SQL执行顺序</h3><p>手写：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> &lt;query_list&gt; <span class="keyword">FROM</span> &lt;left_table&gt;</span><br><span class="line">&lt;<span class="keyword">join</span> <span class="keyword">type</span>&gt; <span class="keyword">JOIN</span> &lt;right_table&gt; <span class="keyword">ON</span> &lt;join_condition&gt;</span><br><span class="line"><span class="keyword">WHERE</span> &lt;wherer_condition&gt;</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> &lt;group_by_list&gt;</span><br><span class="line"><span class="keyword">HAVING</span> &lt;having_condition&gt;</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> &lt;order_by_list&gt;</span><br><span class="line"><span class="keyword">LIMIT</span> &lt;<span class="keyword">limit</span> <span class="built_in">number</span>&gt;</span><br></pre></td></tr></table></figure>



<p>机读：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">FROM &lt;left_table&gt; </span><br><span class="line">ON &lt;join_condition&gt;</span><br><span class="line">&lt;join_type&gt; JOIN &lt;right_table&gt;</span><br><span class="line">WHERE &lt;where_condition&gt;</span><br><span class="line">GROUP BY &lt;group_by_list&gt;</span><br><span class="line">HAVING &lt;having_condition&gt;</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line"><span class="keyword">DISTINCT</span> &lt;query_list&gt;</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> &lt;order_by_condition&gt;</span><br><span class="line"><span class="keyword">LIMIT</span> &lt;limit_number&gt;</span><br></pre></td></tr></table></figure>



<p>总结：</p>
<p><img src="https://images2015.cnblogs.com/blog/1054685/201706/1054685-20170626154318664-711238691.jpg" alt="img"></p>
<p>Join图</p>
<p><img src="https://images2015.cnblogs.com/blog/1054685/201706/1054685-20170626113414446-2016950911.jpg" alt="img"></p>
<h3 id="2-2-MySQL数据库实例"><a href="#2-2-MySQL数据库实例" class="headerlink" title="2.2 MySQL数据库实例"></a>2.2 MySQL数据库实例</h3><h4 id="1-创建数据库："><a href="#1-创建数据库：" class="headerlink" title="1.创建数据库："></a>1.创建数据库：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; create database db_test;</span><br><span class="line">Query OK, 1 row affected (0.01 sec)</span><br></pre></td></tr></table></figure>

<h4 id="2-使用数据库："><a href="#2-使用数据库：" class="headerlink" title="2.使用数据库："></a>2.使用数据库：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; use db_test;</span><br><span class="line">Database changed</span><br></pre></td></tr></table></figure>

<h4 id="3-创建表、添加数据："><a href="#3-创建表、添加数据：" class="headerlink" title="3.创建表、添加数据："></a>3.创建表、添加数据：</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`tb_dept`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT <span class="keyword">COMMENT</span> <span class="string">'部门主键'</span>,</span><br><span class="line">  <span class="string">`deptName`</span> <span class="built_in">varchar</span>(<span class="number">30</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'部门名称'</span>,</span><br><span class="line">  <span class="string">`locAdd`</span> <span class="built_in">varchar</span>(<span class="number">40</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'楼层'</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> AUTO_INCREMENT=<span class="number">1</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`tb_emp`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT <span class="keyword">COMMENT</span> <span class="string">'员工主键'</span>,</span><br><span class="line">  <span class="string">`name`</span> <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'员工姓名'</span>,</span><br><span class="line">  <span class="string">`deptId`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'部门外键'</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>),</span><br><span class="line">  <span class="keyword">KEY</span> <span class="string">`fk_dept_id`</span> (<span class="string">`deptId`</span>)</span><br><span class="line">  <span class="comment">#CONSTRAINT `fk_dept_id` FOREIGN KEY (`deptId`) REFERENCES `tb_dept` (`id`) COMMENT '部门外键设置, 已经注释掉。'</span></span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> AUTO_INCREMENT=<span class="number">1</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`tb_dept`</span> <span class="keyword">VALUES</span> (<span class="string">'1'</span>, <span class="string">'RD'</span>, <span class="string">'11'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`tb_dept`</span> <span class="keyword">VALUES</span> (<span class="string">'2'</span>, <span class="string">'HR'</span>, <span class="string">'12'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`tb_dept`</span> <span class="keyword">VALUES</span> (<span class="string">'3'</span>, <span class="string">'MK'</span>, <span class="string">'13'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`tb_dept`</span> <span class="keyword">VALUES</span> (<span class="string">'4'</span>, <span class="string">'MIS'</span>, <span class="string">'14'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`tb_dept`</span> <span class="keyword">VALUES</span> (<span class="string">'5'</span>, <span class="string">'FD'</span>, <span class="string">'15'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`tb_emp`</span> <span class="keyword">VALUES</span> (<span class="string">'1'</span>, <span class="string">'张三'</span>, <span class="string">'1'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`tb_emp`</span> <span class="keyword">VALUES</span> (<span class="string">'2'</span>, <span class="string">'李四'</span>, <span class="string">'1'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`tb_emp`</span> <span class="keyword">VALUES</span> (<span class="string">'3'</span>, <span class="string">'王二'</span>, <span class="string">'1'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`tb_emp`</span> <span class="keyword">VALUES</span> (<span class="string">'4'</span>, <span class="string">'麻子'</span>, <span class="string">'2'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`tb_emp`</span> <span class="keyword">VALUES</span> (<span class="string">'5'</span>, <span class="string">'小马'</span>, <span class="string">'2'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`tb_emp`</span> <span class="keyword">VALUES</span> (<span class="string">'6'</span>, <span class="string">'马旭'</span>, <span class="string">'3'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`tb_emp`</span> <span class="keyword">VALUES</span> (<span class="string">'7'</span>, <span class="string">'小丁'</span>, <span class="string">'4'</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`tb_emp`</span> <span class="keyword">VALUES</span> (<span class="string">'8'</span>, <span class="string">'小西'</span>, <span class="string">'51'</span>);</span><br></pre></td></tr></table></figure>

<p><strong>tb_emp表数据：</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from tb_emp;</span><br><span class="line">+<span class="comment">----+--------+--------+</span></span><br><span class="line">| id | name   | deptId |</span><br><span class="line">+<span class="comment">----+--------+--------+</span></span><br><span class="line">|  1 | 张三   |      1 |</span><br><span class="line">|  2 | 李四   |      1 |</span><br><span class="line">|  3 | 王二   |      1 |</span><br><span class="line">|  4 | 麻子   |      2 |</span><br><span class="line">|  5 | 小马   |      2 |</span><br><span class="line">|  6 | 马旭   |      3 |</span><br><span class="line">|  7 | 小丁   |      4 |</span><br><span class="line">|  8 | 小西   |     51 |</span><br><span class="line">+<span class="comment">----+--------+--------+</span></span><br><span class="line">8 rows in <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br></pre></td></tr></table></figure>



<p><strong>tb_dept表数据：</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from tb_dept;</span><br><span class="line">+<span class="comment">----+----------+--------+</span></span><br><span class="line">| id | deptName | locAdd |</span><br><span class="line">+<span class="comment">----+----------+--------+</span></span><br><span class="line">|  1 | RD       | 11     |</span><br><span class="line">|  2 | HR       | 12     |</span><br><span class="line">|  3 | MK       | 13     |</span><br><span class="line">|  4 | MIS      | 14     |</span><br><span class="line">|  5 | FD       | 15     |</span><br><span class="line">+<span class="comment">----+----------+--------+</span></span><br><span class="line">5 rows in <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br></pre></td></tr></table></figure>



<p><strong>笛卡儿积：</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from tb_emp, tb_dept;</span><br><span class="line">+<span class="comment">----+--------+--------+----+----------+--------+</span></span><br><span class="line">| id | name   | deptId | id | deptName | locAdd |</span><br><span class="line">+<span class="comment">----+--------+--------+----+----------+--------+</span></span><br><span class="line">|  1 | 张三   |      1 |  1 | RD       | 11     |</span><br><span class="line">|  1 | 张三   |      1 |  2 | HR       | 12     |</span><br><span class="line">|  1 | 张三   |      1 |  3 | MK       | 13     |</span><br><span class="line">|  1 | 张三   |      1 |  4 | MIS      | 14     |</span><br><span class="line">|  1 | 张三   |      1 |  5 | FD       | 15     |</span><br><span class="line">|  2 | 李四   |      1 |  1 | RD       | 11     |</span><br><span class="line">|  2 | 李四   |      1 |  2 | HR       | 12     |</span><br><span class="line">|  2 | 李四   |      1 |  3 | MK       | 13     |</span><br><span class="line">|  2 | 李四   |      1 |  4 | MIS      | 14     |</span><br><span class="line">|  2 | 李四   |      1 |  5 | FD       | 15     |</span><br><span class="line">|  3 | 王二   |      1 |  1 | RD       | 11     |</span><br><span class="line">|  3 | 王二   |      1 |  2 | HR       | 12     |</span><br><span class="line">|  3 | 王二   |      1 |  3 | MK       | 13     |</span><br><span class="line">|  3 | 王二   |      1 |  4 | MIS      | 14     |</span><br><span class="line">|  3 | 王二   |      1 |  5 | FD       | 15     |</span><br><span class="line">|  4 | 麻子   |      2 |  1 | RD       | 11     |</span><br><span class="line">|  4 | 麻子   |      2 |  2 | HR       | 12     |</span><br><span class="line">|  4 | 麻子   |      2 |  3 | MK       | 13     |</span><br><span class="line">|  4 | 麻子   |      2 |  4 | MIS      | 14     |</span><br><span class="line">|  4 | 麻子   |      2 |  5 | FD       | 15     |</span><br><span class="line">|  5 | 小马   |      2 |  1 | RD       | 11     |</span><br><span class="line">|  5 | 小马   |      2 |  2 | HR       | 12     |</span><br><span class="line">|  5 | 小马   |      2 |  3 | MK       | 13     |</span><br><span class="line">|  5 | 小马   |      2 |  4 | MIS      | 14     |</span><br><span class="line">|  5 | 小马   |      2 |  5 | FD       | 15     |</span><br><span class="line">|  6 | 马旭   |      3 |  1 | RD       | 11     |</span><br><span class="line">|  6 | 马旭   |      3 |  2 | HR       | 12     |</span><br><span class="line">|  6 | 马旭   |      3 |  3 | MK       | 13     |</span><br><span class="line">|  6 | 马旭   |      3 |  4 | MIS      | 14     |</span><br><span class="line">|  6 | 马旭   |      3 |  5 | FD       | 15     |</span><br><span class="line">|  7 | 小丁   |      4 |  1 | RD       | 11     |</span><br><span class="line">|  7 | 小丁   |      4 |  2 | HR       | 12     |</span><br><span class="line">|  7 | 小丁   |      4 |  3 | MK       | 13     |</span><br><span class="line">|  7 | 小丁   |      4 |  4 | MIS      | 14     |</span><br><span class="line">|  7 | 小丁   |      4 |  5 | FD       | 15     |</span><br><span class="line">|  8 | 小西   |     51 |  1 | RD       | 11     |</span><br><span class="line">|  8 | 小西   |     51 |  2 | HR       | 12     |</span><br><span class="line">|  8 | 小西   |     51 |  3 | MK       | 13     |</span><br><span class="line">|  8 | 小西   |     51 |  4 | MIS      | 14     |</span><br><span class="line">|  8 | 小西   |     51 |  5 | FD       | 15     |</span><br><span class="line">+<span class="comment">----+--------+--------+----+----------+--------+</span></span><br><span class="line">40 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>



<p><strong>查询tb_emp表和tb_dept中公共的数据：</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from tb_emp e</span><br><span class="line">    -&gt; inner join tb_dept d on e.deptId = d.id;</span><br><span class="line">+<span class="comment">----+--------+--------+----+----------+--------+</span></span><br><span class="line">| id | name   | deptId | id | deptName | locAdd |</span><br><span class="line">+<span class="comment">----+--------+--------+----+----------+--------+</span></span><br><span class="line">|  1 | 张三   |      1 |  1 | RD       | 11     |</span><br><span class="line">|  2 | 李四   |      1 |  1 | RD       | 11     |</span><br><span class="line">|  3 | 王二   |      1 |  1 | RD       | 11     |</span><br><span class="line">|  4 | 麻子   |      2 |  2 | HR       | 12     |</span><br><span class="line">|  5 | 小马   |      2 |  2 | HR       | 12     |</span><br><span class="line">|  6 | 马旭   |      3 |  3 | MK       | 13     |</span><br><span class="line">|  7 | 小丁   |      4 |  4 | MIS      | 14     |</span><br><span class="line">+<span class="comment">----+--------+--------+----+----------+--------+</span></span><br><span class="line">7 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>



<p><strong>查询tb_emp表中全部的数据：</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from tb_emp e</span><br><span class="line">    -&gt; left join tb_dept d on e.deptId = d.id;</span><br><span class="line">    </span><br><span class="line"><span class="comment">#该条数据为 tb_emp 表中独有的数据, tb_dept 表中的字段用 null 占位</span></span><br><span class="line">+<span class="comment">----+--------+--------+------+----------+--------+</span></span><br><span class="line">| id | name   | deptId | id   | deptName | locAdd |</span><br><span class="line">+<span class="comment">----+--------+--------+------+----------+--------+</span></span><br><span class="line">|  1 | 张三   |      1 |    1 | RD       | 11     |</span><br><span class="line">|  2 | 李四   |      1 |    1 | RD       | 11     |</span><br><span class="line">|  3 | 王二   |      1 |    1 | RD       | 11     |</span><br><span class="line">|  4 | 麻子   |      2 |    2 | HR       | 12     |</span><br><span class="line">|  5 | 小马   |      2 |    2 | HR       | 12     |</span><br><span class="line">|  6 | 马旭   |      3 |    3 | MK       | 13     |</span><br><span class="line">|  7 | 小丁   |      4 |    4 | MIS      | 14     |</span><br><span class="line">|  8 | 小西   |     51 | NULL | NULL     | NULL   |　　　　</span><br><span class="line">+<span class="comment">----+--------+--------+------+----------+--------+</span></span><br><span class="line">8 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>



<p><strong>查询tb_dept表中全部的数据：</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from tb_emp e</span><br><span class="line">    -&gt; right join tb_dept d on e.deptId = d.id;</span><br><span class="line">    </span><br><span class="line"><span class="comment">#该条数据为 tb_dept 表中独有的数据, tb_emp 表中的字段用 null 占位</span></span><br><span class="line">+<span class="comment">------+--------+--------+----+----------+--------+</span></span><br><span class="line">| id   | name   | deptId | id | deptName | locAdd |</span><br><span class="line">+<span class="comment">------+--------+--------+----+----------+--------+</span></span><br><span class="line">|    1 | 张三   |      1 |  1 | RD       | 11     |</span><br><span class="line">|    2 | 李四   |      1 |  1 | RD       | 11     |</span><br><span class="line">|    3 | 王二   |      1 |  1 | RD       | 11     |</span><br><span class="line">|    4 | 麻子   |      2 |  2 | HR       | 12     |</span><br><span class="line">|    5 | 小马   |      2 |  2 | HR       | 12     |</span><br><span class="line">|    6 | 马旭   |      3 |  3 | MK       | 13     |</span><br><span class="line">|    7 | 小丁   |      4 |  4 | MIS      | 14     |</span><br><span class="line">| NULL | NULL   |   NULL |  5 | FD       | 15     |     </span><br><span class="line">+<span class="comment">------+--------+--------+----+----------+--------+</span></span><br><span class="line">8 rows in <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br></pre></td></tr></table></figure>



<p><strong>查询tb_emp表中独有的数据：</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from tb_emp e</span><br><span class="line">    -&gt; left join tb_dept d on e.deptId = d.id</span><br><span class="line">    -&gt; where d.id is null;</span><br><span class="line">+<span class="comment">----+--------+--------+------+----------+--------+</span></span><br><span class="line">| id | name   | deptId | id   | deptName | locAdd |</span><br><span class="line">+<span class="comment">----+--------+--------+------+----------+--------+</span></span><br><span class="line">|  8 | 小西   |     51 | NULL | NULL     | NULL   |</span><br><span class="line">+<span class="comment">----+--------+--------+------+----------+--------+</span></span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>



<p><strong>查询tb_dept表中独有的数据：</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from tb_emp e</span><br><span class="line">    -&gt; right join tb_dept d on e.deptId = d.id</span><br><span class="line">    -&gt; where e.deptId is null;</span><br><span class="line">+<span class="comment">------+------+--------+----+----------+--------+</span></span><br><span class="line">| id   | name | deptId | id | deptName | locAdd |</span><br><span class="line">+<span class="comment">------+------+--------+----+----------+--------+</span></span><br><span class="line">| NULL | NULL |   NULL |  5 | FD       | 15     |</span><br><span class="line">+<span class="comment">------+------+--------+----+----------+--------+</span></span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>



<p><strong>查询tb_emp和tb_dept表中所有的数据：</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from tb_emp e</span><br><span class="line">    -&gt; full outer join tb_dept d on e.deptId = d.id;</span><br><span class="line">ERROR 1064 (42000): You have an error in your SQL syntax; <span class="keyword">check</span> the <span class="keyword">manual</span> that corresponds <span class="keyword">to</span> your MySQL <span class="keyword">server</span> <span class="keyword">version</span> <span class="keyword">for</span> the <span class="keyword">right</span> syntax <span class="keyword">to</span> <span class="keyword">use</span> near <span class="string">'full outer join tb_dept d on e.deptId = d.id'</span> <span class="keyword">at</span> line <span class="number">2</span></span><br></pre></td></tr></table></figure>

<p>出错原因：mysql 中不支持这种连接方式。</p>
<p><strong>解决办法：</strong>左连接数据和右连接数据相加，将公共的部分去重。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from tb_emp e </span><br><span class="line">    -&gt; left join tb_dept d on e.deptId &#x3D; d.id</span><br><span class="line">    -&gt; union　　　　　#去重</span><br><span class="line">    -&gt; select * from tb_emp e</span><br><span class="line">    -&gt; right join tb_dept d on e.deptId &#x3D; d.id;</span><br><span class="line">    </span><br><span class="line">#该条数据为 tb_emp 表中独有的数据, tb_dept 表中的字段用 null 占位</span><br><span class="line">#该条数据为 tb_dept 表中独有的数据, tb_emp 表中的字段用 null 占位</span><br><span class="line">+------+--------+--------+------+----------+--------+</span><br><span class="line">| id   | name   | deptId | id   | deptName | locAdd |</span><br><span class="line">+------+--------+--------+------+----------+--------+</span><br><span class="line">|    1 | 张三   |      1 |    1 | RD       | 11     |</span><br><span class="line">|    2 | 李四   |      1 |    1 | RD       | 11     |</span><br><span class="line">|    3 | 王二   |      1 |    1 | RD       | 11     |</span><br><span class="line">|    4 | 麻子   |      2 |    2 | HR       | 12     |</span><br><span class="line">|    5 | 小马   |      2 |    2 | HR       | 12     |</span><br><span class="line">|    6 | 马旭   |      3 |    3 | MK       | 13     |</span><br><span class="line">|    7 | 小丁   |      4 |    4 | MIS      | 14     |</span><br><span class="line">|    8 | 小西   |     51 | NULL | NULL     | NULL   |　　　　</span><br><span class="line">| NULL | NULL   |   NULL |    5 | FD       | 15     |　　　 </span><br><span class="line">+------+--------+--------+------+----------+--------+</span><br><span class="line">9 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>



<p><strong>查询tb_emp和tb_dept表中独有的数据：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from tb_emp e</span><br><span class="line">    -&gt; left join tb_dept d on e.deptId &#x3D; d.id</span><br><span class="line">    -&gt; where d.id is null</span><br><span class="line">    -&gt; union</span><br><span class="line">    -&gt; select * from tb_emp e</span><br><span class="line">    -&gt; right join tb_dept d on e.deptId &#x3D; d.id</span><br><span class="line">    -&gt; where e.deptId is null;</span><br><span class="line">+------+--------+--------+------+----------+--------+</span><br><span class="line">| id   | name   | deptId | id   | deptName | locAdd |</span><br><span class="line">+------+--------+--------+------+----------+--------+</span><br><span class="line">|    8 | 小西   |     51 | NULL | NULL     | NULL   |</span><br><span class="line">| NULL | NULL   |   NULL |    5 | FD       | 15     |</span><br><span class="line">+------+--------+--------+------+----------+--------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>





<p>7种Join</p>
<h2 id="3-索引简介"><a href="#3-索引简介" class="headerlink" title="3.索引简介"></a>3.索引简介</h2><p><strong>索引概述：</strong></p>
<ul>
<li>索引(Index) 是帮助MySQL高效获取数据的数据结构。索引的本质就是数据结构。 索引的目的在于提高查询效率，可以类比字典，可以简单的理解为“排好序的快速查找数据结构”。</li>
<li>在数据本身之外，数据库系统还维护着满足特定查找算法的数据结构，这些数据结构以某种方式引用(指向)数据，这样就可以在这些数据结构上实现高级查找算法。这种数据结构就是索引。</li>
<li>一般来说索引本身也很大，不可能全部存储在内存中，因此索引往往以索引文件的形式存储在磁盘上。</li>
<li>我们平时所说的索引，如果没有特别指明，都是指B树结构组织的索引。</li>
</ul>
<p><strong>二叉树算法图：</strong></p>
<p><strong><a href="https://images2015.cnblogs.com/blog/1054685/201706/1054685-20170627085051383-985324526.png" target="_blank" rel="noopener"><img src="https://images2015.cnblogs.com/blog/1054685/201706/1054685-20170627085051383-985324526.png" alt="img"></a></strong></p>
<p>​    为了加快Col2的查找，可以维护一个右边所示的二叉查找树，每个节点分别包含索引键值和一个指向对应数据记录物理地址的指针，这样就可以运用二叉查找在一定复杂度内获取到相应数据，从而快速的检索出符合条件的记录。</p>
<p><strong>索引的优势：</strong></p>
<ol>
<li>创建索引可以提高数据检索的效率，降低数据库的IO成本。</li>
<li>通过索引列对数据进行排序，降低数据排序的成本，降低了CPU的消耗。</li>
</ol>
<p><strong>索引的劣势：</strong></p>
<ol>
<li>索引其实也是一张表，该表保存了主键与索引字段，并指向实体的记录，所以索引列也是要占用空间的。</li>
<li>索引虽然提高了查询速度，同时却会降低更新表的速度，如对表进行INSERT、UPDATE和DELETE。因为更新表时，MySQL不仅要保存数据，还要调整因为更新所带来的键值变化后的索引信息。</li>
<li>索引只是提高效率的一个因素，如果MySQL有大数据量的表，就需要花时间研究建立最优秀的索引，或优化查询语句。</li>
</ol>
<p><strong>MySQL索引分类：</strong></p>
<ol>
<li>单值索引：一个索引只包含一个单列，一个表可以有多个单列索引。</li>
<li>唯一索引：索引列的值必须唯一，但允许有空值。</li>
<li>复合索引：一个索引包含多个列。</li>
</ol>
<p><strong>索引的基本语法：</strong></p>
<ul>
<li><strong>创建：</strong></li>
</ul>
<ol>
<li>CREATE [UNIQUE] INDEX indexName ON tableName(colName(length));。——如果是CHAR、VARCHAR类型，length可以小于字段实际长度，若是BLOB和TEXT类型，必须指定length。</li>
<li>ALTER tableName ADD [UNIQUE] INDEX indexName ON (colName(length));。</li>
</ol>
<ul>
<li><strong>删除：</strong>DROP INDEX [indexName] ON tableName;　　</li>
<li><strong>查看：</strong>SHOW INDEX FROM tableName;</li>
</ul>
<p><strong>使用ALTER命令四种方式添加数据表的索引：</strong></p>
<ol>
<li>ALTER TABLE tableName ADD PRIMARY KEY(column_list); 该语句添加一个主键，这意味着索引值必须唯一，且不能为null。</li>
<li>ALTER TABLE tableName ADD UNIQUE indexName(column_list);该语句创建索引的值必须唯一(null除外，null可能会出现多次)。</li>
<li>ALTER TABLE tableName ADD INDEX indexName(column_list);该语句添加普通索引，索引值可出现多次。</li>
<li>AKTER TABLE tableName ADD FULLTEXT indexName(column_list);该语句指定索引为FULLTEXT，用于全文索引。</li>
</ol>
<p><strong>MySQL索引结构：</strong></p>
<ol>
<li>BTree索引</li>
<li>Hash索引</li>
<li>full-text全文索引</li>
<li>R-Tree索引</li>
</ol>
<p>java工程师掌握BTree就可以。</p>
<p><strong>哪些情况需要创建索引：</strong></p>
<ol>
<li>主键自动建立唯一索引。</li>
<li>频繁作为查询条件的字段应该创建索引。</li>
<li>查询中与其他表关联的字段，外键关系建立索引。</li>
<li>在高并发下倾向创建组合索引。</li>
<li>查询中的排序字段适合创建索引，排序字段若通过索引去访问将大大提高排序速率。</li>
<li>查询中统计或者分组字段适合创建索引。</li>
</ol>
<p><strong>哪些情况不要创建索引：</strong></p>
<ol>
<li>where条件里用不到的字段不创建索引。</li>
<li>表记录太少。</li>
<li>频繁更新的字段不不适合创建索引。——因为每次更新不仅更新了记录还会更新索引，加重了IO负担。</li>
<li>经常增删改的表。</li>
<li>数据重复且平均分录的表字段，建立索引没有太大的实际效果。</li>
</ol>
<h2 id="4-性能分析"><a href="#4-性能分析" class="headerlink" title="4.性能分析"></a>4.性能分析</h2><h2 id="5-索引优化"><a href="#5-索引优化" class="headerlink" title="5.索引优化"></a>5.索引优化</h2><h1 id="三-查询截取分析"><a href="#三-查询截取分析" class="headerlink" title="三.查询截取分析"></a>三.查询截取分析</h1><h1 id="四-MySQL锁机制"><a href="#四-MySQL锁机制" class="headerlink" title="四.MySQL锁机制"></a>四.MySQL锁机制</h1><h1 id="五-主从复制"><a href="#五-主从复制" class="headerlink" title="五.主从复制"></a>五.主从复制</h1>
    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/MySQL%E9%AB%98%E7%BA%A7/" rel="tag"># MySQL高级</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/11/20/JDK8%E6%96%B0%E7%89%B9%E6%80%A7/" rel="prev" title="JDK8新特性">
      <i class="fa fa-chevron-left"></i> JDK8新特性
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/11/20/%E5%BF%AB%E9%80%9F%E6%9E%84%E5%BB%BAJava-Web%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/" rel="next" title="快速构建Java Web项目的开发环境">
      快速构建Java Web项目的开发环境 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#一-mysql的架构介绍"><span class="nav-number">1.</span> <span class="nav-text">一.mysql的架构介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-MysqlLinux版本的安装–mysql5-5"><span class="nav-number">1.1.</span> <span class="nav-text">1. MysqlLinux版本的安装–mysql5.5</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-下载地址"><span class="nav-number">1.1.1.</span> <span class="nav-text">1.1 下载地址</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-检查当前系统是否安装过mysql"><span class="nav-number">1.1.2.</span> <span class="nav-text">1.2 检查当前系统是否安装过mysql</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-安装mysql服务端-注意提示-与客户端"><span class="nav-number">1.1.3.</span> <span class="nav-text">1.3 安装mysql服务端(注意提示)与客户端</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4-查看Mysql安装时创建的mysql用户和mysql组"><span class="nav-number">1.1.4.</span> <span class="nav-text">1.4 查看Mysql安装时创建的mysql用户和mysql组</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-5-mysql服务的启动和停止"><span class="nav-number">1.1.5.</span> <span class="nav-text">1.5 mysql服务的启动和停止</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-6-mysql的ROOT密码设置"><span class="nav-number">1.1.6.</span> <span class="nav-text">1.6 mysql的ROOT密码设置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-7-自启动mysql服务"><span class="nav-number">1.1.7.</span> <span class="nav-text">1.7 自启动mysql服务</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-8-修改配置文件位置"><span class="nav-number">1.1.8.</span> <span class="nav-text">1.8 修改配置文件位置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-9-修改字符集和数据存储路径"><span class="nav-number">1.1.9.</span> <span class="nav-text">1.9 修改字符集和数据存储路径</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-10-Mysql的安装位置"><span class="nav-number">1.1.10.</span> <span class="nav-text">1.10 Mysql的安装位置</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-Mysql配置文件"><span class="nav-number">1.2.</span> <span class="nav-text">2.Mysql配置文件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-二进制日志log-bin"><span class="nav-number">1.2.1.</span> <span class="nav-text">2.1 二进制日志log-bin</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-错误日志log-error"><span class="nav-number">1.2.2.</span> <span class="nav-text">2.2 错误日志log-error</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-查询日志log"><span class="nav-number">1.2.3.</span> <span class="nav-text">2.3 查询日志log</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-数据文件"><span class="nav-number">1.2.4.</span> <span class="nav-text">2.4 数据文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-5-如何配置"><span class="nav-number">1.2.5.</span> <span class="nav-text">2.5 如何配置</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-Mysql逻辑架构介绍"><span class="nav-number">1.3.</span> <span class="nav-text">3.Mysql逻辑架构介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-连接层"><span class="nav-number">1.3.1.</span> <span class="nav-text">3.1 连接层</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-服务层"><span class="nav-number">1.3.2.</span> <span class="nav-text">3.2 服务层</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-引擎层"><span class="nav-number">1.3.3.</span> <span class="nav-text">3.3 引擎层</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-存储层"><span class="nav-number">1.3.4.</span> <span class="nav-text">3.4 存储层</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-Mysql存储引擎"><span class="nav-number">1.4.</span> <span class="nav-text">4.Mysql存储引擎</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#二-索引优化分析"><span class="nav-number">2.</span> <span class="nav-text">二.索引优化分析</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-性能下降SQL慢-，执行时间长-，等待时间长的原因分析"><span class="nav-number">2.1.</span> <span class="nav-text">1.性能下降SQL慢 ，执行时间长 ，等待时间长的原因分析</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-常见通用的join查询"><span class="nav-number">2.2.</span> <span class="nav-text">2.常见通用的join查询</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-SQL执行顺序"><span class="nav-number">2.2.1.</span> <span class="nav-text">2.1 SQL执行顺序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-MySQL数据库实例"><span class="nav-number">2.2.2.</span> <span class="nav-text">2.2 MySQL数据库实例</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-创建数据库："><span class="nav-number">2.2.2.1.</span> <span class="nav-text">1.创建数据库：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-使用数据库："><span class="nav-number">2.2.2.2.</span> <span class="nav-text">2.使用数据库：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-创建表、添加数据："><span class="nav-number">2.2.2.3.</span> <span class="nav-text">3.创建表、添加数据：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-索引简介"><span class="nav-number">2.3.</span> <span class="nav-text">3.索引简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-性能分析"><span class="nav-number">2.4.</span> <span class="nav-text">4.性能分析</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-索引优化"><span class="nav-number">2.5.</span> <span class="nav-text">5.索引优化</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#三-查询截取分析"><span class="nav-number">3.</span> <span class="nav-text">三.查询截取分析</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#四-MySQL锁机制"><span class="nav-number">4.</span> <span class="nav-text">四.MySQL锁机制</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#五-主从复制"><span class="nav-number">5.</span> <span class="nav-text">五.主从复制</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="liubin"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">liubin</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">42</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">20</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">41</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/liuurick" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;liuurick" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:liuurick@gmail.com" title="E-Mail → mailto:liuurick@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/liuurick" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;liuurick" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://instagram.com/liuurick" title="Instagram → https:&#x2F;&#x2F;instagram.com&#x2F;liuurick" rel="noopener" target="_blank"><i class="fab fa-instagram fa-fw"></i>Instagram</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">liubin</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
